<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Portfolio Optimization in Reinsurance | Kristina Williams, CQF</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <!-- Link to your existing styles -->
  <link rel="stylesheet" href="../styles.css" />
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
  
  <!-- MathJax for LaTeX -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [['$$', '$$']]
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  
  <!-- Syntax highlighting -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  
  <!-- Plotly for interactive graphs - load at end of head to ensure it's available -->
  <script src="https://cdn.plot.ly/plotly-2.27.0.min.js" charset="utf-8"></script>
  
  <style>
    /* Blog post styling */
    .post-container {
      max-width: 900px;
      margin: 0 auto;
      padding: 60px 20px;
      line-height: 1.8;
    }
    
    .post-header {
      margin-bottom: 40px;
      border-bottom: 2px solid #e0e0e0;
      padding-bottom: 30px;
    }
    
    .post-title {
      font-family: 'Playfair Display', serif;
      font-size: 2.5rem;
      color: #1a1a1a;
      margin-bottom: 15px;
      line-height: 1.3;
    }
    
    .post-meta {
      color: #666;
      font-size: 0.95rem;
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }
    
    .abstract {
      background: #f8f9fa;
      padding: 25px;
      border-left: 4px solid #2563eb;
      margin: 30px 0;
      font-style: italic;
    }
    
    .post-content h2 {
      font-family: 'Playfair Display', serif;
      font-size: 1.8rem;
      color: #1a1a1a;
      margin-top: 50px;
      margin-bottom: 20px;
      border-bottom: 1px solid #e0e0e0;
      padding-bottom: 10px;
    }
    
    .post-content h3 {
      font-size: 1.3rem;
      color: #333;
      margin-top: 35px;
      margin-bottom: 15px;
    }
    
    .post-content p {
      margin-bottom: 20px;
      color: #333;
    }
    
    .post-content ul, .post-content ol {
      margin-bottom: 20px;
      padding-left: 30px;
    }
    
    .post-content li {
      margin-bottom: 10px;
    }
    
    /* Interactive figure styling */
    .figure {
      margin: 40px 0;
    }
    
    .figure-caption {
      margin-top: 15px;
      font-size: 0.9rem;
      color: #666;
      font-style: italic;
      text-align: center;
    }
    
    .equation {
      margin: 30px 0;
      overflow-x: auto;
    }
    
    pre {
      background: #f6f8fa;
      padding: 20px;
      border-radius: 6px;
      overflow-x: auto;
      margin: 25px 0;
    }
    
    code {
      font-family: 'Courier New', monospace;
      font-size: 0.9em;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 30px 0;
    }
    
    th, td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }
    
    th {
      background-color: #f8f9fa;
      font-weight: 600;
    }
    
    .references {
      margin-top: 60px;
      padding-top: 30px;
      border-top: 2px solid #e0e0e0;
    }
    
    .references ol {
      font-size: 0.95rem;
      line-height: 1.6;
    }
    
    .references li {
      margin-bottom: 15px;
    }
  </style>
</head>

<body>

<header class="site-header">
  <div class="container nav-bar">
    <div class="logo">
      <img src="../nometria-logo.png" alt="NometriaRe logo" class="logo-img" />
      <div class="logo-text">
        <span class="logo-main">Kristina Williams, CQF</span>
        <span class="logo-sub">CONSULTING & RESEARCH</span>
      </div>
    </div>
    <nav class="nav-links">
      <a href="../index.html">‚Üê Back to Home</a>
    </nav>
  </div>
</header>

<main>
  <article class="post-container">
    
    <div class="post-header">
      <h1 class="post-title">Portfolio Optimization in Reinsurance: A Stochastic Programming Approach</h1>
      <div class="post-meta">
        <span>üìÖ January 15, 2026</span>
        <span>‚è±Ô∏è 12 min read</span>
        <span>üè∑Ô∏è Reinsurance, Portfolio Optimization, Risk Management</span>
      </div>
    </div>

    <div class="abstract">
      <strong>Abstract:</strong> We present a comprehensive framework for optimizing reinsurance portfolios under 
      tail-risk constraints using stochastic programming techniques. By incorporating catastrophe loss distributions, 
      correlation structures, and capital allocation requirements, we demonstrate how reinsurers can construct 
      efficient portfolios that balance return objectives with regulatory capital constraints and risk appetite.
    </div>

    <div class="post-content">
      
      <h2>1. Introduction</h2>
      <p>
        Reinsurance portfolio construction presents unique challenges compared to traditional financial portfolios. 
        Unlike equity or fixed-income assets that exhibit relatively continuous return distributions, reinsurance 
        treaties are exposed to catastrophic tail events with highly skewed loss distributions.
      </p>

      <h2>2. Mathematical Framework</h2>
      
      <h3>2.1 Portfolio Loss Distribution</h3>
      <p>
        Consider a reinsurance portfolio consisting of \(n\) treaties. Let \(L_i\) denote the random loss 
        from treaty \(i\), and \(w_i\) the proportion of capital allocated to treaty \(i\). The aggregate 
        portfolio loss is:
      </p>
      
      <div class="equation">
        $$L_p = \sum_{i=1}^{n} w_i L_i$$
      </div>

      <h3>2.2 Optimization Problem</h3>
      <p>
        We formulate the portfolio optimization as a constrained stochastic program:
      </p>
      
      <div class="equation">
        $$\begin{aligned}
        \max_{w} \quad & \mathbb{E}[R_p] - \lambda \cdot \text{CVaR}_\alpha(L_p) \\
        \text{s.t.} \quad & \sum_{i=1}^{n} w_i = 1 \\
        & \text{VaR}_{0.995}(L_p) \leq K_{cap}
        \end{aligned}$$
      </div>

      <!-- INTERACTIVE GRAPH 1: EFFICIENT FRONTIER -->
      <div class="figure">
        <div id="efficientFrontier" style="width:100%;height:500px;"></div>
        <p class="figure-caption">
          <strong>Figure 1:</strong> Efficient frontier showing the return versus CVaR‚Çâ‚Çâ.‚ÇÖ tradeoff. 
          The red point indicates the optimal portfolio under a capital constraint. Hover for exact values.
        </p>
      </div>

      <h2>3. Results</h2>
      
      <h3>3.1 Portfolio Composition</h3>
      <p>
        Applying our framework to a sample portfolio of property catastrophe treaties, we obtain 
        the following optimal allocation:
      </p>

      <table>
        <thead>
          <tr>
            <th>Treaty</th>
            <th>Peril</th>
            <th>Region</th>
            <th>Weight (%)</th>
            <th>Expected Loss Ratio</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>US Wind QS</td>
            <td>Hurricane</td>
            <td>Gulf Coast</td>
            <td>12.3</td>
            <td>68%</td>
          </tr>
          <tr>
            <td>CA Earthquake XL</td>
            <td>Earthquake</td>
            <td>California</td>
            <td>8.5</td>
            <td>45%</td>
          </tr>
          <tr>
            <td>EU Windstorm QS</td>
            <td>Windstorm</td>
            <td>Western Europe</td>
            <td>15.7</td>
            <td>72%</td>
          </tr>
          <tr>
            <td>JP Earthquake XL</td>
            <td>Earthquake</td>
            <td>Japan</td>
            <td>9.2</td>
            <td>38%</td>
          </tr>
          <tr>
            <td>Other treaties</td>
            <td>Various</td>
            <td>Global</td>
            <td>54.3</td>
            <td>55%</td>
          </tr>
        </tbody>
      </table>

      <!-- INTERACTIVE GRAPH 2: PORTFOLIO COMPOSITION BAR CHART -->
      <div class="figure">
        <div id="portfolioComposition" style="width:100%;height:400px;"></div>
        <p class="figure-caption">
          <strong>Figure 2:</strong> Optimal portfolio weights by treaty.
        </p>
      </div>

      <!-- INTERACTIVE GRAPH 3: CORRELATION MATRIX -->
      <div class="figure">
        <div id="correlationMatrix" style="width:100%;height:600px;"></div>
        <p class="figure-caption">
          <strong>Figure 3:</strong> Correlation matrix of treaty losses estimated from Monte Carlo scenarios. 
          Note the strong correlation between US Wind and CA Earthquake.
        </p>
      </div>

      <!-- INTERACTIVE GRAPH 4: LOSS DISTRIBUTION -->
      <div class="figure">
        <div id="lossDistribution" style="width:100%;height:500px;"></div>
        <p class="figure-caption">
          <strong>Figure 4:</strong> Simulated aggregate loss distribution with VaR and CVaR markers. 
          Zoom and pan to explore the tail.
        </p>
      </div>

      <h2>4. Conclusion</h2>
      <p>
        This framework demonstrates how modern portfolio theory can be adapted for reinsurance applications 
        by incorporating heavy-tailed loss distributions, complex dependence structures, and regulatory 
        capital constraints.
      </p>

      <div class="references">
        <h2>References</h2>
        <ol>
          <li>
            Rockafellar, R.T., & Uryasev, S. (2000). "Optimization of conditional value-at-risk." 
            <em>Journal of Risk</em>, 2(3), 21-42.
          </li>
          <li>
            McNeil, A.J., Frey, R., & Embrechts, P. (2015). <em>Quantitative Risk Management</em>. 
            Princeton University Press.
          </li>
        </ol>
      </div>

    </div>

  </article>
</main>

<footer class="site-footer">
  <div class="container footer-inner">
    <span>¬© <span id="year"></span> Kristina Williams. All rights reserved.</span>
  </div>
</footer>

<!-- JAVASCRIPT TO GENERATE ALL GRAPHS -->
<script>
document.getElementById("year").textContent = new Date().getFullYear();

// Check if Plotly loaded
console.log('Plotly loaded:', typeof Plotly !== 'undefined');

// Function to create all graphs
function createGraphs() {
  
  // Check if Plotly is available
  if (typeof Plotly === 'undefined') {
    console.error('Plotly library not loaded!');
    document.querySelectorAll('.figure > div').forEach(div => {
      div.innerHTML = '<p style="color: red; padding: 20px;">Error: Plotly library failed to load. Please refresh the page.</p>';
    });
    return;
  }
  
  console.log('Creating graphs...');
  
  // GRAPH 1: EFFICIENT FRONTIER
  // Step 1: Create the data arrays
  const cvarValues = [];
  const returnValues = [];
  
  // Step 2: Generate efficient frontier points
  for (let i = 0; i < 50; i++) {
    const cvar = 150 + (i * 5);  // CVaR from 150 to 400
    const ret = 5 + 8 * (1 - Math.exp(-0.008 * (cvar - 150))) + (Math.random() - 0.5) * 0.3;
    cvarValues.push(cvar);
    returnValues.push(ret);
  }
  
  // Step 3: Create the plot data
  const efficientFrontierData = [
    {
      x: cvarValues,
      y: returnValues,
      mode: 'lines+markers',
      name: 'Efficient Frontier',
      line: { color: '#2563eb', width: 3 },
      marker: { size: 6 }
    },
    {
      x: [312],
      y: [8.2],
      mode: 'markers',
      name: 'Optimal Portfolio',
      marker: { color: 'red', size: 15, symbol: 'diamond' }
    }
  ];
  
  // Step 4: Create layout with styling
  const efficientFrontierLayout = {
    title: 'Reinsurance Portfolio Efficient Frontier',
    xaxis: { 
      title: 'CVaR‚Çâ‚Çâ.‚ÇÖ ($ millions)',
      gridcolor: '#e5e5e5'
    },
    yaxis: { 
      title: 'Expected Return (% ROE)',
      gridcolor: '#e5e5e5'
    },
    hovermode: 'closest',
    plot_bgcolor: '#fafafa',
    shapes: [{
      type: 'line',
      x0: 250, x1: 250,
      y0: 5, y1: 9,
      line: { color: 'gray', width: 2, dash: 'dash' }
    }],
    annotations: [{
      x: 250,
      y: 8.5,
      text: 'Capital Constraint',
      showarrow: true,
      arrowhead: 2,
      ax: -40,
      ay: -40
    }]
  };
  
  // Step 5: Render the plot
  Plotly.newPlot('efficientFrontier', efficientFrontierData, efficientFrontierLayout, {responsive: true});

  
  // GRAPH 2: PORTFOLIO COMPOSITION BAR CHART
  const portfolioData = [{
    y: ['Other Treaties', 'JP EQ XL', 'CA EQ XL', 'US Wind QS', 'EU Wind QS'],
    x: [54.3, 9.2, 8.5, 12.3, 15.7],
    type: 'bar',
    orientation: 'h',
    marker: {
      color: ['#dbeafe', '#93c5fd', '#60a5fa', '#3b82f6', '#2563eb'],
      line: { color: 'black', width: 0.5 }
    },
    text: ['54.3%', '9.2%', '8.5%', '12.3%', '15.7%'],
    textposition: 'outside',
    hovertemplate: '%{y}: %{x}%<extra></extra>'
  }];
  
  const portfolioLayout = {
    title: 'Optimal Portfolio Composition',
    xaxis: { 
      title: 'Portfolio Weight (%)',
      range: [0, 65]
    },
    yaxis: { title: '' },
    plot_bgcolor: '#fafafa',
    showlegend: false
  };
  
  Plotly.newPlot('portfolioComposition', portfolioData, portfolioLayout, {responsive: true});

  
  // GRAPH 3: CORRELATION MATRIX HEATMAP
  const treaties = ['US Wind', 'CA EQ', 'EU Wind', 'JP EQ', 'AU Flood', 'UK Wind', 
                    'FL Hurr', 'TX Wind', 'Multi', 'Excess', 'Pro-Rata', 'Cat Bond'];
  
  // Create correlation matrix (simplified)
  const corrMatrix = [
    [1.00, 0.35, 0.22, 0.15, 0.18, 0.20, 0.75, 0.62, 0.28, 0.25, 0.30, 0.12],
    [0.35, 1.00, 0.18, 0.18, 0.15, 0.12, 0.28, 0.25, 0.32, 0.22, 0.20, 0.15],
    [0.22, 0.18, 1.00, 0.10, 0.25, 0.68, 0.20, 0.18, 0.30, 0.28, 0.25, 0.18],
    [0.15, 0.18, 0.10, 1.00, 0.22, 0.12, 0.15, 0.12, 0.25, 0.20, 0.18, 0.10],
    [0.18, 0.15, 0.25, 0.22, 1.00, 0.28, 0.20, 0.18, 0.30, 0.25, 0.22, 0.15],
    [0.20, 0.12, 0.68, 0.12, 0.28, 1.00, 0.18, 0.15, 0.25, 0.22, 0.20, 0.12],
    [0.75, 0.28, 0.20, 0.15, 0.20, 0.18, 1.00, 0.55, 0.35, 0.30, 0.28, 0.15],
    [0.62, 0.25, 0.18, 0.12, 0.18, 0.15, 0.55, 1.00, 0.30, 0.25, 0.22, 0.12],
    [0.28, 0.32, 0.30, 0.25, 0.30, 0.25, 0.35, 0.30, 1.00, 0.45, 0.40, 0.25],
    [0.25, 0.22, 0.28, 0.20, 0.25, 0.22, 0.30, 0.25, 0.45, 1.00, 0.35, 0.20],
    [0.30, 0.20, 0.25, 0.18, 0.22, 0.20, 0.28, 0.22, 0.40, 0.35, 1.00, 0.18],
    [0.12, 0.15, 0.18, 0.10, 0.15, 0.12, 0.15, 0.12, 0.25, 0.20, 0.18, 1.00]
  ];
  
  const heatmapData = [{
    z: corrMatrix,
    x: treaties,
    y: treaties,
    type: 'heatmap',
    colorscale: 'RdYlBu',
    reversescale: true,
    zmin: -0.5,
    zmax: 1.0,
    colorbar: { title: 'Correlation' }
  }];
  
  const heatmapLayout = {
    title: 'Correlation Matrix of Treaty Losses',
    xaxis: { side: 'bottom' },
    yaxis: { autorange: 'reversed' },
    width: 700,
    height: 600
  };
  
  Plotly.newPlot('correlationMatrix', heatmapData, heatmapLayout, {responsive: true});

  
  // GRAPH 4: LOSS DISTRIBUTION HISTOGRAM
  // Generate lognormal losses
  const losses = [];
  for (let i = 0; i < 10000; i++) {
    // Box-Muller transform for normal
    const u1 = Math.random();
    const u2 = Math.random();
    const z = Math.sqrt(-2 * Math.log(u1)) * Math.cos(2 * Math.PI * u2);
    // Lognormal with mu=4.5, sigma=0.8
    const loss = Math.exp(4.5 + 0.8 * z);
    losses.push(loss);
  }
  
  // Calculate VaR and CVaR
  losses.sort((a, b) => a - b);
  const var995 = losses[Math.floor(losses.length * 0.995)];
  const tailLosses = losses.slice(Math.floor(losses.length * 0.995));
  const cvar995 = tailLosses.reduce((a, b) => a + b, 0) / tailLosses.length;
  
  const histogramData = [
    {
      x: losses,
      type: 'histogram',
      nbinsx: 50,
      name: 'Simulated Losses',
      marker: { color: '#3b82f6', line: { color: 'black', width: 0.5 } },
      opacity: 0.7
    }
  ];
  
  const histogramLayout = {
    title: 'Monte Carlo Simulated Loss Distribution',
    xaxis: { 
      title: 'Aggregate Portfolio Loss ($ millions)',
      range: [0, 500]
    },
    yaxis: { title: 'Frequency' },
    shapes: [
      {
        type: 'line',
        x0: var995, x1: var995,
        y0: 0, y1: 1,
        yref: 'paper',
        line: { color: 'darkred', width: 2, dash: 'dash' }
      },
      {
        type: 'line',
        x0: cvar995, x1: cvar995,
        y0: 0, y1: 1,
        yref: 'paper',
        line: { color: 'maroon', width: 2, dash: 'dot' }
      }
    ],
    annotations: [
      {
        x: var995,
        y: 0.9,
        yref: 'paper',
        text: `VaR‚Çâ‚Çâ.‚ÇÖ = $${var995.toFixed(0)}M`,
        showarrow: true,
        arrowhead: 2,
        ax: 40,
        ay: 0
      },
      {
        x: cvar995,
        y: 0.75,
        yref: 'paper',
        text: `CVaR‚Çâ‚Çâ.‚ÇÖ = $${cvar995.toFixed(0)}M`,
        showarrow: true,
        arrowhead: 2,
        ax: 40,
        ay: 0
      }
    ],
    plot_bgcolor: '#fafafa'
  };
  
  Plotly.newPlot('lossDistribution', histogramData, histogramLayout, {responsive: true});
  
  Plotly.newPlot('lossDistribution', histogramData, histogramLayout, {responsive: true});
  
  console.log('All graphs created successfully!');
}

// Wait for both DOM and Plotly to be ready
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', function() {
    setTimeout(createGraphs, 100); // Small delay to ensure Plotly is ready
  });
} else {
  setTimeout(createGraphs, 100);
}

// Also try to highlight code if hljs is available
if (typeof hljs !== 'undefined') {
  hljs.highlightAll();
}

</script>

</body>
</html>
